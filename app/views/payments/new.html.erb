<div id="body-container">
  <div class="container">
    <div class="row">
          <div class="col-xs-12 col-md-6 col-md-offset-3 text-center form-box" style="height:500px;;">
          <h3 class="form-header">MON PANIER</h3>
          <table class="table table-hover">
            <thead>
              <tr>
                <th>Quantit√©</th>
                <th>Plat</th>
                <th class="text-center">Prix</th>
              </tr>
            </thead>

            <tbody>
              <tr>
                <td class="text-left"><%= @order.quantity %></td>
                <td  class="text-left"><%= @order.meal.name %></td>
                <td><%= @order.amount.format %></td>
              </tr>
            </tbody>

          </table>
             <div class="  col-xs-12 col-sm-12 " style="margin:auto; border-radius:3px">

                  <h4>Montant total = <%= humanized_money_with_symbol(@amount) %></h4>

            </div>

        <div style="padding-top:50px;">
         <%= form_tag cart_payments_path(@order) do %>
             <script src="https://checkout.stripe.com/checkout.js"></script>

              <button id="customButton" class="btn btn-payer">Payer</button>

               <script>
                  var handler = StripeCheckout.configure({
                  key: '<%= Rails.configuration.stripe[:publishable_key] %>',
                  image: '/assets/logo.ico',
                 token: function(response) {
                  var tokenInput = $("<input type=hidden name=stripeToken />").val(response.id);
                  var emailInput = $("<input type=hidden name=stripeEmail />").val(response.email);
                  $("form").append(tokenInput).append(emailInput).submit();
                }
                    });

                  document.getElementById('customButton').addEventListener('click', function(e) {
                    // Open Checkout with further options
                    handler.open({
                      name: 'La box des chefs',
                      description: "<%= @order.meal.name %>",
                      amount: "<%= @order.amount_cents %>",
                      currency:"EUR",

                    });
                    e.preventDefault();
                  });
                </script>

                <% end %>
        </div>



      </div>
    </div>
  </div>
</div>


