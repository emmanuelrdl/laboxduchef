<div id="body-container" >
  <div id="banner-container-meal-index">
    <h2 class="title_meal-index-lg text-center">LES MEILLEURES OFFRES AUTOUR DE <%= params[:full_addressuser_input_autocomplete_address] %> </h2>
  </div>
    <div class="container-meal-index hidden-xs">
      <div class="row">
        <div class="col-xs-12 col-sm-8 col-md-8 col-lg-8 ">
            <div class=" meals-list">
             <% if  Meal.where(active:true).count == 0 %>
                <div class="text-center">
              <p class="font-25">Il n'y a malhreusement pas d'offres en cours pour le moment ! </p>
                <p class="font-25" >N'hésitez pas à présenter le projet à vos amis restaurateurs pour que ceux-ci rejoignent notre version beta !</p>
                </div>
              <% else %>
                 <div id="my-meals">
                    <%= render @meals %>
                  </div>
                  <div class="col-xs-12" id="infinite-scrolling">
                   <%= will_paginate @meals, renderer: BootstrapPagination::Rails %>
                  </div>
                  <% end -%>
            </div>
          </div>
          <div class="search-meal-index-toggled hidden-xs col-xs-12 col-sm-4">
            <div class='change_place text-center'>
              <p id="change_place_block"> Lieu: <%= params[:full_addressuser_input_autocomplete_address] %>
                  <button href="" id="change_place"> MODIFIER </button>
              </p>
                <div id="index_address_input">
                  <%= simple_form_for :search, url: meals_path, :method => :get do |f| %>
                      <p><%= text_field_tag :full_addressuser_input_autocomplete_address, '', id:"user_input_autocomplete_address", class:"form-control index-address-field-lg", placeholder:"Saisissez votre addresse" , value:"Châtelet - Les Halles, Paris, France"  %> </p>
                     <p> <%= f.button :submit, "Voir", class: "btn btn-search-meal-index-lg" %></p>
                    <% end -%>
                </div>
              </div>

             <div id="map" name="map" class="map-index-lg" >
             </div>
        </div>
      </div>
    </div>






    <div class="container-index-xs hidden-md hidden-lg hidden-sm">
      <div class="row" >
        <div class="col-xs-12 col-sm-12 block-index-xs  ">
           <% if  Meal.where(active:true).count == 0 %>
            <div class="col-xs-12 text-center" >
                <p class="font-25">Il n'y a malhreusement pas d'offres en cours pour le moment ! </p>
                 <img src="https://maxcdn.icons8.com/Color/PNG/96/Users/cook-96.png" title="Cook" width="96" style="margin-bottom:20px;margin-top:20px;">
                <p class="font-25" >N'hésitez pas à présenter le projet à vos amis restaurateurs pour que ceux-ci rejoignent notre version beta !</p>
            </div>

            <% else %>
               <div id="my-meals-xs">
                  <%= render 'meals/mealxs', renderer: BootstrapPagination::Rails  %>
               </div>
               <div id="infinite-scrolling">
               <%= will_paginate @meals %>
              </div>
            <% end -%>

          </div>
        </div>
      </div>

</div>



    <% content_for(:after_js) do %>
    <script>
    $(document).on('ready', function() {
      var handler = Gmaps.build('Google');
      handler.buildMap({ internal: { id: 'map' } }, function(){
        markers = handler.addMarkers(<%= raw @markers.to_json %>);
        handler.bounds.extendWith(markers);
        handler.fitMapToBounds();
        console.log(markers)

            });

    });

    $(document).ready(function() {
      if ($('.pagination').length) {
        $(window).scroll(function() {
          var url = $('.pagination .next_page').attr('href');
          if (url && $(window).scrollTop() > $(document).height() - $(window).height() - 50) {
            $('.pagination').text("Chargement en cours...");
            return $.getScript(url);
          }
        });
        return $(window).scroll();
      }
    });



    </script>
    <% end %>

