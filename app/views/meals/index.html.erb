<div id="body-container" >

    <div class="container-meal-index hidden-xs">
      <div class="row">
        <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6 ">
          <h4 class="title-illustration " id="text-meal-index">OFFRES EN COURS</h4>
            <div class=" meals-list">
             <% if  Meal.where(active:true).count == 0 %>
                <div class="text-center">
              <p class="font-25">Il n'y a malhreusement pas d'offres en cours pour le moment ! </p>
                 <img src="https://maxcdn.icons8.com/Color/PNG/96/Users/cook-96.png" title="Cook" width="96" style="margin-bottom:20px;margin-top:20px;">
                <p class="font-25" >N'hésitez pas à présenter le projet à vos amis restaurateurs pour que ceux-ci rejoignent notre version beta !</p>
                </div>
              <% else %>
                 <div id="my-meals">
                    <%= render @meals %>
                 </div>
                  <div class="col-xs-12" id="infinite-scrolling">
                   <%= will_paginate @meals, renderer: BootstrapPagination::Rails %>
                  </div>
                  <% end -%>
            </div>
          </div>
          <div class="col-xs-12 col-sm-6">
            <h4 class="title-illustration" id="text-meal-index">CARTE</h4>
               <div id="map" name="map" style="height:620px; margin-left:10px; margin-right:10px; margin-bottom:10px; margin-top:12px; border-radius:3px;border:1px solid grey">
               </div>
          </div>
        </div>
      </div>
    </div>





    <div class="container-index-xs hidden-md hidden-lg hidden-sm">
      <div class="row" >
        <div class="col-xs-12 col-sm-12 block-index-xs  ">
           <% if  Meal.where(active:true).count == 0 %>
            <div class="col-xs-12 text-center" >
                <p class="font-25">Il n'y a malhreusement pas d'offres en cours pour le moment ! </p>
                 <img src="https://maxcdn.icons8.com/Color/PNG/96/Users/cook-96.png" title="Cook" width="96" style="margin-bottom:20px;margin-top:20px;">
                <p class="font-25" >N'hésitez pas à présenter le projet à vos amis restaurateurs pour que ceux-ci rejoignent notre version beta !</p>
            </div>

            <% else %>
               <div id="my-meals-xs">
                  <%= render 'meals/mealxs', renderer: BootstrapPagination::Rails  %>
               </div>
               <div id="infinite-scrolling">
               <%= will_paginate @meals %>
              </div>
            <% end -%>

          </div>
        </div>
      </div>

</div>




    <% content_for(:after_js) do %>
    <script>
    $(document).on('ready', function() {
      var handler = Gmaps.build('Google');
      handler.buildMap({ internal: { id: 'map' } }, function(){
        markers = handler.addMarkers(<%= raw @markers.to_json %>);
        handler.bounds.extendWith(markers);
        handler.fitMapToBounds();
        console.log(markers)

              // var i, len, marker;

              // var infowindow = new google.maps.InfoWindow();
              // for (i = 0, len = markers.length; i < len; i++) {
                // marker = markers[i];
                // google.maps.event.addListener(marker.getServiceObject(), 'mouseover', function(e, b,c) {
                  // console.log(this);
                  // console.log(handler);
                  // infowindow.open(map, this);
                  // console.log(this.position.lat());
                  // console.log(this.position.lng());
                // });
              // }

            });

    });

    $(document).ready(function() {
      if ($('.pagination').length) {
        $(window).scroll(function() {
          var url = $('.pagination .next_page').attr('href');
          if (url && $(window).scrollTop() > $(document).height() - $(window).height() - 50) {
            $('.pagination').text("Chargement en cours...");
            return $.getScript(url);
          }
        });
        return $(window).scroll();
      }
    });



    </script>
    <% end %>

